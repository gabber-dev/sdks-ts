{"version":3,"names":["_livekitClient","require","_reactNative","_track_volume_visualizer","_api","registerGlobals","RealtimeSessionEngine","agentParticipant","agentTrack","_microphoneEnabledState","transcriptions","_agentState","_remainingSeconds","id","constructor","onConnectionStateChanged","onMessagesChanged","onMicrophoneChanged","onAgentVolumeChanged","onUserVolumeChanged","onAgentStateChanged","onRemainingSecondsChanged","onAgentError","onCanPlayAudioChanged","livekitRoom","Room","on","onRoomConnected","bind","onRoomDisconnected","onTrackSubscribed","onTrackUnsubscribed","onDataReceived","onParticipantMetadataChanged","onLocalTrackPublished","onLocalTrackUnpublished","onTrackMuted","onTrackUnmuted","onAudioPlaybackChangaed","agentVolumeVisualizer","TrackVolumeVisualizer","onTick","bands","userVolumeVisualizer","connect","opts","connectionDetails","undefined","connection_details","api","Api","token","res","realtime","startRealtimeSession","url","data","Error","autoSubscribe","canPlaybackAudio","disconnect","startAudio","e","console","error","setMicrophoneEnabled","enabled","localParticipant","sendChatMessage","text","te","TextEncoder","encoded","encode","JSON","stringify","publishData","topic","agentState","value","remainingSeconds","destroy","removeAllListeners","microphoneEnabledState","resolveMicrophoneState","isMicrophoneEnabled","publication","participant","log","isLocal","kind","Track","Kind","Audio","setTrack","audioTrack","_","metadataString","metadata","parse","track","pub","attachedElements","forEach","el","remove","state","decoded","TextDecoder","decode","message","i","length","agent","push","payload","isAgent","md","remaining_seconds","agent_state","exports"],"sourceRoot":"../../../src","sources":["lib/session.ts"],"mappings":"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","ignoreList":[]}
