{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_livekitClient","_api","_jsxRuntime","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","registerGlobals","RealtimeSessionEngineContext","createContext","undefined","RealtimeSessionEngineProvider","connectionOpts","children","conDetails","setConDetails","useState","error","setError","useEffect","connection_details","api","Api","token","realtime","startRealtimeSession","then","res","data","catch","err","message","jsx","LiveKitRoom","serverUrl","url","connect","Boolean","RealtimeSessionEngineProviderInner","useDataChannel","agentParticipant","useRemoteParticipant","kind","ParticipantKind","AGENT","localParticipant","microphoneTrack","isMicrophoneEnabled","useLocalParticipant","metadata","useRoomInfo","roomConnectionState","useConnectionState","messages","setMessages","lastError","setLastError","transcription","setTranscription","text","final","lastUserMessage","useMemo","length","agent","id","JSON","parse","decoded","TextDecoder","decode","payload","topic","messageData","prev","newMessages","existingIndex","findIndex","m","push","setMicrophoneEnabled","useCallback","enabled","sendChatMessage","p","console","te","TextEncoder","encoded","encode","stringify","publishData","agentMicrophoneTrack","useAgentMicrophoneTrack","agentVolumeBands","useMultibandTrackVolume","maxFrequency","minFrequency","bands","updateInterval","userVolumeBands","track","agentVolume","useTrackVolume","userVolume","connectionState","ConnectionState","Disconnected","Connecting","Reconnecting","agentMetadata","useAgentMetadata","agentState","remainingSeconds","md","remaining_seconds","agent_state","Provider","value","microphoneEnabled","useParticipantInfo","participant","allTracks","useTracks","Track","Source","Microphone","identity","publication","useRealtimeSessionEngine","context","React","useContext","Error"],"sourceRoot":"../../../src","sources":["providers/realtime_session_engine.tsx"],"mappings":"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","ignoreList":[]}
