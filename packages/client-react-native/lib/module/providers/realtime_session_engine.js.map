{"version":3,"names":["createContext","useEffect","useState","useMemo","useCallback","React","LiveKitRoom","useConnectionState","useDataChannel","useLocalParticipant","useMultibandTrackVolume","useRemoteParticipant","useRoomInfo","useTrackVolume","registerGlobals","useParticipantInfo","useTracks","ParticipantKind","ConnectionState","Track","Api","jsx","_jsx","RealtimeSessionEngineContext","undefined","RealtimeSessionEngineProvider","connectionOpts","children","conDetails","setConDetails","error","setError","connection_details","api","token","realtime","startRealtimeSession","then","res","data","catch","err","message","serverUrl","url","connect","Boolean","RealtimeSessionEngineProviderInner","agentParticipant","kind","AGENT","localParticipant","microphoneTrack","isMicrophoneEnabled","metadata","roomConnectionState","messages","setMessages","lastError","setLastError","transcription","setTranscription","text","final","lastUserMessage","i","length","agent","id","JSON","parse","decoded","TextDecoder","decode","payload","topic","messageData","prev","newMessages","existingIndex","findIndex","m","push","setMicrophoneEnabled","enabled","sendChatMessage","p","console","te","TextEncoder","encoded","encode","stringify","publishData","agentMicrophoneTrack","useAgentMicrophoneTrack","agentVolumeBands","maxFrequency","minFrequency","bands","updateInterval","userVolumeBands","track","agentVolume","userVolume","connectionState","Disconnected","Connecting","Reconnecting","agentMetadata","useAgentMetadata","agentState","remainingSeconds","md","remaining_seconds","agent_state","Provider","value","microphoneEnabled","participant","allTracks","Source","Microphone","t","identity","publication","useRealtimeSessionEngine","context","useContext","Error"],"sourceRoot":"../../../src","sources":["providers/realtime_session_engine.tsx"],"mappings":"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","ignoreList":[]}
